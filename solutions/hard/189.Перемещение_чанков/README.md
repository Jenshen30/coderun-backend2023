189. Перемещение чанков

(some words duplicated, sorry. It was awful to delete them...)

Хранение данных в распределённом хранилище является крайне сложной задачей, однако инженеры Яндекса успешно с ней справляются.

Один из кластеров хранилища состоит из mm серверов, на которых хранятся данные, разбитые на nn чанков. Для дефрагментации кластера и возможности отключения старых серверов чанки периодически приходится перемещать между серверами. Перемещение чанков по одному неэффективно, поэтому чанки перемещают группами. Запрос на перемещение чанков описывается четырьмя числами a,b,l,ra,b,l,r и обозначает заказ на перемещение всех чанков с номерами от ll до rr включительно с сервера с номером aa на сервер с номером bb. После перемещения соотвествующие чанки с сервера с номером aa стираются. Таким образом, каждый чанк находится всегда ровно на одном сервере.

При построении распределённых систем очень важно избегать возможности конфликта изменений на кластере. Перед выполнением каждого из запросов необходимо убедиться, что все чанки, участвующие в запросе, находятся на ожидаемом сервере. Иными словами, перед выполнением запроса, описываемого параметрами a,b,l,ra,b,l,r, необходимо убедиться, что все чанки с номерами от ll до rr включительно, расположены на сервере с номером aa. В случае, если это неверно, запрос на перемещение чанков отменяется, и система переходит к обработке следующего запроса. Если же это верно, то запрос осуществляется и все чанки от ll до rr включительно перемещаются с сервера aa на сервер bb.

По заданому начальному состоянию кластера и списку запросов перемещения чанков определите, какие запросы будут выполнены.
Формат ввода

В первой строке заданы три целых числа n,mn,m и qq (1≤n,q≤100 000,2≤m≤100 0001≤n,q≤100000,2≤m≤100000) — количество чанков на кластере, количество серверов, на которых располагаются чанки, и количество запросов, соответсвенно.

Во второй строке содержатся nn чисел pipi​ (1≤pi≤m1≤pi​≤m), ii-е из которых обозначает номер сервера, на котором изначально располагается чанк с номером ii.

В следующих qq строках содежатся описания запросов перемещения чанков в хронологическом порядке.

Каждый запрос описывается четвёркой чисел ai,bi,li,riai​,bi​,li​,ri​ (1≤ai,bi≤m,ai≠bi,1≤li≤ri≤n1≤ai​,bi​≤m,ai​=bi​,1≤li​≤ri​≤n) и обозначает заказ на перемещение чанков с номерами с lili​ по riri​ (включительно) с сервера aiai​ на сервер bibi​.
Формат вывода

Выведите qq строк. В строке с номером ii выведите 11, если запрос с номером ii будет выполнен, и 00 иначе.
Примечание

Рассмотрим третий пример. Изначально, расположение чанков на серверах описывается массивом [1,2,3,4,5].

В первом запросе требуется переместить чанк с номером 11 с сервера 11 на сервер 22. Чанк с номером 11 находится на сервере 11, поэтому перемещение будет произведено. После выполнения запроса расположение чанков на серверах описывается массивом [2,2,3,4,5][2,2,3,4,5].

Во втором запросе требуется переместить чанки 1,21,2 и 33 с сервера 22 на сервер 33. Чанк 33 расположен не на сервере 22, а на сервере 33, поэтому операция не будет выполнена. Расположение чанков на серверах останется прежним.

В третьем запросе требуется переместить чанк 44 с сервера 44 на сервер 22. Чанк 44 находится на сервере 44, поэтому перемещение будет произведено. После выполнения запроса расположение чанков на серверах будет описываться массивом [2,2,3,2,5][2,2,3,2,5].

В четвёртом запросе требуется переместить чанки 1,2,31,2,3 и 44 с сервера 22 на сервер 55. Так как чанк 33 расположен на сервере 33, а не на сервере 22, запрос не будет выполнен и расположение чанков останется прежним.

В пятом запросе требуется переместить чанки 22 и 33 с сервера 33 на сервер 22, но чанк 22 расположен на сервере 22, поэтому запрос не будет выполнен, и расположение чанков останется прежним.

В шестом запросе требуется переместить чанк 33 с сервера 33 на сервер 22. Чанк с номером 33 находится на сервере 33, поэтому перемещение будет произведено, и расположение чанков станет описываться массивом [2,2,2,2,5].

[Решение](solution.cpp)