176. День рождения Васи

(some words duplicated, sorry)

Вася и его друзья очень любят вкусно поесть. На свой день рождения каждый обязан удивить других, приготовив новые вкусные и полезные блюда.

Сегодня у Васи день рождения и он позвал своих друзей отведать nn своих самых лучших блюд. Название каждого из них состоит из строчных букв английского алфавита, цифр и знака подчёркивания.

Для приготовления блюда с номером ii требуется zizi​ ингредиентов. Для каждого ингридиента известно его название, требуемое количество для одной порции блюда, а также единица измерения, в которой это количество задано. Помимо этого, Васе известно, что ii-й кулинарный шедевр захотят попробовать cici​ друзей.

Используются следующие единицы измерения:

    g, kg — граммы и килограммы, соответственно;
    l, ml — литры и миллилитры, соответственно;
    cnt, tens — одна штука и десять штук, соответственно.

В одном килограмме 10001000 грамм и в одном литре 10001000 миллилитров. Делать перевод из одной единицы измерения в другую можно тогда и только тогда, когда они одновременно обозначают или массу, или объём, или количество.

У Васи есть два справочника ингредиентов. В первом для каждого ингредиента указано его количество в упаковке и цена за упаковку. Во втором справочнике для каждого ингредиента указано содержание белков, жиров, углеводов и энергетическая ценность некоторого количества данного ингредиента.

Васе нужно приготовить все блюда, при этом не купить ничего лишнего. Для этого ему нужно определить, какие ингредиенты и в каком количестве необходимо приобрести в магазине.

Так как друзья именинника очень следят за тем, что едят, то они, перед тем как попробовать Васины блюда, захотят узнать всё про них: как Вася готовил блюда, нет ли в продуктах ГМО, энергетическую ценность каждого блюда и содержание белков, жиров и углеводов в нём. Васе нужно также предоставить эту информацию.

Необходимо помочь имениннику подсчитать, сколько требуется потратить денег на покупку продуктов в магазине, какие ингредиенты и в каком количестве нужно купить, а также для каждого блюда подсчитать содержание белков, жиров, углеводов и энергетическую ценность, если его съесть полностью.
Формат ввода

Первая строка содержит целое число nn (1⩽n⩽10001⩽n⩽1000) — количество блюд, которое решил приготовить Вася.

Затем следует описание nn блюд. В первой строке содержатся строка didi​ и целые числа cici​, zizi​ (1⩽ci,zi⩽1001⩽ci​,zi​⩽100) — название блюда, количество друзей, желающих отведать данное блюдо, и количество ингредиентов необходимых для приготовления. Название блюда состоит из строчных букв английского алфавита, цифр и знака подчёркивания. Его длина не превосходит 2020 символов.

В следующих zizi​ строках содеражтся описания ингредиентов. В строке с номером jj содержатся строка si,jsi,j​ — название ингредиента, целое число ai,jai,j​ (1⩽ai,j⩽10001⩽ai,j​⩽1000) — требуемое количество ингредиента и строка ui,jui,j​ — название единицы измерения количества. Название ингредиента состоит из строчных букв английского алфавита, цифр и знака подчёркивания. Длина строки не превосходит 2020 символов.

Следующая строка содержит целое число kk (1⩽k⩽10001⩽k⩽1000) — количество ингредиентов в каталоге цен.

В каждой из следующих kk строк, содержатся четыре значения ti pi ai uiti​pi​ai​ui​, описывающих ингредиент.

    titi​ — название ингредиента, состоящее из строчных букв английского алфавита, цифр и знака подчёркивания. Длина строки не превосходит 2020 символов;
    pipi​ — стоимость ингредиента, заданная целым числом (1⩽pi⩽10001⩽pi​⩽1000);
    aiai​ — количество ингредиента в упаковке в единицах, заданное целым числом (1⩽ai⩽10001⩽ai​⩽1000);
    uiui​ — единица измерения количества (l, ml, g, kg, cnt или tens).

Следующая строка содержит число mm (1⩽m⩽10001⩽m⩽1000) — количество ингредиентов в каталоге еды.

Далее расположены mm строк, в каждой из которой содержится семь значений ti ai ui pri fi chi fviti​ai​ui​pri​fi​chi​fvi​, описывающих ингредиент.

    titi​ — название ингредиента, состоящее из строчных букв английского алфавита, цифр и знака подчёркивания. Длина строки не превосходит 2020 символов;
    aiai​ — количество ингредиента, для которого указаны характеристики ингредиента, заданное целым числом (1⩽ai⩽10001⩽ai​⩽1000);
    uiui​ — единица измерения (l, ml, g, kg, cnt или tens);
    pripri​, fifi​, chichi​, fvifvi​ — содержание белков, жиров, углеводов и энергетическая ценность ингредиента, соответственно, заданные вещественными числами с не более чем шестью знаками после запятой (0⩽pri,fi,chi⩽1000,0⩽fvi⩽100000⩽pri​,fi​,chi​⩽1000,0⩽fvi​⩽10000).

Гарантируется, что:

    в каталогах перечислены все ингредиенты, необходимые для приготовления блюд;
    не существует двух блюд с одинаковым названием;
    не существует двух ингредиентов в одном каталоге с одинаковым названием;
    не существует двух ингредиентов в одном блюде с одинаковым названием;
    для любых двух упоминаний ингридиента единицы измерения, в которых заданы его количества, можно перевести друг в друга.

Формат вывода

Первая строка должна содержать одно целое число: количество денег, которое нужно потратить Васе на подготовку к празднику.

Далее должны следовать kk строк, в каждой из которых через пробел указано название ингредиента и целое число — количество упаковок, которое необходимо купить. Ингредиенты, выведенные в этих kk строках должны соответствовать ингредиентам, описанным в первом справочнике.

В следующих nn строках через пробел должны быть указаны название блюда и его характеристики, описанные четырьмя вещественными числами: белки, жиры, углеводы и энергетическая ценность.

Ингредиенты и блюда разрешается выводить в любом порядке.

Ваш ответ будет считаться правильным, если все целые числа совпадают с соответствующими числами в ответе жюри, а для всех вещественных чисел в ответе их абсолютная или относительная погрешность не превосходит 10−310−3. Более формально, пусть вещественное число в вашем ответе равно AA, а соответствующее число в ответе жюри равно BB. Тогда число AA будет считаться корректным, если ∣A−B∣max⁡(1,B)≤10−3max(1,B)∣A−B∣​≤10−3.
Примечание

В первом примере Васе необходимо приготовить 77 бутербродов и 99 омлетов.

Для приготовления всех первых блюд необходимо 10⋅710⋅7 грамм масла, 2⋅72⋅7 кусочков хлеба и 30⋅730⋅7 грамм колбасы. В каждом из бутерброде будет содержаться 0.8⋅10100+7.3⋅25+10⋅30100=60.8⋅10010​+7.3⋅52​+10⋅10030​=6 грамм белков, 72.5⋅10100+1.6⋅25+18⋅30100=13.2972.5⋅10010​+1.6⋅52​+18⋅10030​=13.29 грамм жиров и 1.3⋅10100+52.3⋅25+1.5⋅30100=21.51.3⋅10010​+52.3⋅52​+1.5⋅10030​=21.5 грамм углеводов. Энергетическая ценность составит 661⋅10100+248⋅25+210⋅30100=228.3661⋅10010​+248⋅52​+210⋅10030​=228.3 ккал.

Для приготовления всех вторых блюд необходимо 4⋅9=364⋅9=36 яиц, 120⋅9=1080120⋅9=1080 миллилитров молока, 99 грамм соли, 50⋅9=45050⋅9=450 грамм колбасы. В каждом омлете будет содержаться 13⋅4+3⋅1201000+10⋅50100=57.3613⋅4+3⋅1000120​+10⋅10050​=57.36 грамм белков, 12⋅4+4.5⋅1201000+18⋅50100=57.5412⋅4+4.5⋅1000120​+18⋅10050​=57.54 жиров и 1⋅4+4.7⋅1201000+1.5⋅50100=5.3141⋅4+4.7⋅1000120​+1.5⋅10050​=5.314 углеводов. Энергетическая ценность составит 16.4⋅4+60⋅1201000+210⋅50100=177.816.4⋅4+60⋅1000120​+210⋅10050​=177.8 ккал.

Всего необходимо 7070 грамм масла, 3636 яиц, 10801080 миллилитров молока, 99 грамм соли, 210+450=660210+450=660 грамм колбасы и 1414 кусочков тостового хлеба.

Таким образом, в магазине нужно купить одну упаковку масла, 44 десятка яиц, 22 упаковки колбасы и молока, по одной упаковке соли и тостового хлеба, заплатив 120+61⋅4+100⋅2+58⋅2+14+40=734120+61⋅4+100⋅2+58⋅2+14+40=734 рубля.

[Решение](solution.java)