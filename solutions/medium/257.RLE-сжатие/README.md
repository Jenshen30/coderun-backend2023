257. RLE-сжатие


RLE-сжатие — один из самых простых методов сжатия строки, основанный на сокращении подстрок, состоящих из одинаковых символов. Сжатие осуществляется следующим образом:

    Строка разбивается на минимальное количество подстрок, состоящих из одинаковых символов. Например, abbcaaa превращается в строки a, bb, c, aaa.
    Каждая из полученных строк превращается в строку, состоящую из числа и буквы. Числом является количество повторений символа в этой строке, буква берётся из первого символа обрабатываемой строки. Число не добавляется, если количество символов в строке равно единице. Из предыдущего массива строк мы получаем a, 2b, c, 3a.
    Затем полученные строки конкатенируются в исходном порядке. В рассмотренном примере в итоге получим a2bc3a.

Вам дана строка ss, уже сжатая в RLE-формате. Назовём строку, из которой была получена s, строкой t. Вам даны q запросов, каждый из них представлен целыми числами l и r. В каждом запросе вам необходимо найти длину сжатой подстроки t[l…r].

Формат ввода

В первой строке входного файла записана строка ss, состоящая из строчных букв латинского алфавита и цифр (1≤∣s∣≤1 000 000)(1≤∣s∣≤1000000). Гарантируется, что существует такая непустая строка tt, из которой RLERLE-сжатием получается строка ss. Также гарантируется, что в строке tt не было больше 1 000 000 0001000000000 одинаковых подряд идущих символов.

В следующей строке дано количество запросов q (1≤q≤100 000). Каждая из следующих qq строк содержит два числа li​ и ri​ (1≤li​≤ri​≤∣t∣) — параметры запросов.

Формат вывода

Выведите q чисел, каждое в отдельной строке — ответы на запросы в том порядке, в котором запросы были заданы во входных данных.

[Решение](solution.java)